# Bing Web検索クライアントサーバへの研究室クラスターへのデプロイ

## 手順

- クライアントサーバアプリの作成
- Dockerイメージの作成
- Docker Hubへのアップロード
- k8s設定ファイルの作成と実行
- [Jupyter Notebookからのアクセス](../../k8s/ipynb/bingsearch.ipynb)


###  k8s設定ファイルの作成と実行

- 設定ファイル`my-bingsearch.yaml`の新規作成

```
apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2
kind: Deployment
metadata:
  name: bingsearch
spec:
  selector:
    matchLabels:
      run: bingsearch
      app: bingsearch
  template:
    metadata:
      labels:
        run: bingsearch
        app: bingsearch
    spec:
      containers:
      - name: bingsearch
        image: YOUR-DOCKERHUB-USERNAME/k8s-bingsearch // Change here or use 'hideojoho/k8s-bingsearch'
        ports:
        - containerPort: 5000
        env:
        - name: AZURE_SUBSCRIPTION_KEY
          value: "YOUR-AZURE_SUBSCRIPTION_KEY" // Change here
        - name: AZURE_ENDPOINT
          value: "YOUR-AZURE_ENDPOINT" // Change here
---
apiVersion: v1
kind: Service
metadata:
  name: bingsearch
  labels:
    run: bingsearch
spec:
  ports:
  - port: 5000
    targetPort: 5000
    protocol: TCP
  selector:
    run: bingsearch
```
