# 分散表現の取得

ある語の分散表現の値を取得する方法。学習済みのモデルを用いる。

:bulb: 取得できる語彙やベクトルの形状は学習済みモデルに依存します。

## 前提

- Jupyter Notebookイメージ
  - `hideojoho/jupyter-minimal`を選択

## 手順

以下は全てJupyter Notebook上で実行する

- `gensim`パッケージのインストール

```
import sys
!{sys.executable} -m pip install gensim
```
```
Collecting gensim
  Downloading gensim-3.8.3-cp38-cp38-manylinux1_x86_64.whl (24.2 MB)
     |████████████████████████████████| 24.2 MB 8.4 MB/s eta 0:00:01    |█████████▍                      | 7.1 MB 8.4 MB/s eta 0:00:03
...
Installing collected packages: boto, docutils, jmespath, botocore, s3transfer, boto3, smart-open, numpy, scipy, gensim
Successfully installed boto-2.49.0 boto3-1.14.56 botocore-1.17.56 docutils-0.15.2 gensim-3.8.3 jmespath-0.10.0 numpy-1.19.1 s3transfer-0.3.3 scipy-1.5.2 smart-open-2.1.1
```

- `gensim`パッケージのインポート

```
import gensim
```

- 学習済みモデル一覧

```
!find shared/Datasets/embedding/ | grep bin
```
```
shared/Datasets/embedding/ja/tohoku/entity_vector/entity_vector.model.bin
```

- モデルの選択と読み込み
  - 少し時間がかかります

```
model_path = "~/shared/Datasets/embedding/ja/tohoku/entity_vector/entity_vector.model.bin"
model = gensim.models.KeyedVectors.load_word2vec_format(model_path, binary=True)
```

- 分散表現の獲得
  - 出力される分散表現の次元は学習済みモデルに依存します
  
```
model["東京"]
```
```
array([-4.9377084e-01, -1.0795103e+00, -1.7043670e+00, -2.8346848e-01,
       -9.7921357e-02,  2.9649718e-03, -1.4321026e+00,  2.1180634e+00,
       -6.5057933e-01, -2.4283080e-01, -1.4744743e+00,  2.3692427e+00,
       -1.2232407e+00, -2.5084358e-01, -1.1474016e+00, -1.0077909e+00,
        4.1119050e-02,  3.3181062e-01, -1.7003858e+00,  1.0867200e-01,
       -4.4118047e-01, -6.3031507e-01,  5.2364564e-01, -2.3837712e+00,
       -4.9476680e-01, -9.0679131e-02,  1.1118658e+00, -8.1485015e-01,
       -1.2896284e+00, -1.0107316e+00,  5.6121653e-01, -5.3247905e-01,
        3.4778738e-01,  1.8428134e+00,  1.3640974e+00,  5.3892666e-01,
        1.6043129e+00, -1.1591192e+00,  1.8210863e-01,  7.3196882e-01,
       -1.6724837e-01,  1.6102265e+00, -1.5136610e+00, -1.1521746e+00,
        1.4132180e+00,  4.6848136e-01, -1.6361024e+00,  9.7744596e-01,
        2.3130195e+00,  2.2589984e+00,  1.9880196e+00, -9.8160291e-01,
        9.7532803e-01, -7.7486479e-01,  4.7683126e-01,  5.2713335e-01,
        2.5420341e+00, -1.0450951e+00, -2.4210735e-01,  1.9530278e-02,
       -8.3461303e-01,  1.2937716e+00, -7.9786241e-01, -5.9018803e-01,
       -6.2737978e-01,  9.0730554e-01, -8.1932145e-01,  2.6290922e+00,
        1.4800259e+00,  1.2973558e+00, -1.6641167e+00, -2.8452906e-01,
       -8.9406438e-02,  2.0061322e-01,  4.7872892e-01,  3.7760136e-01,
        2.0665078e+00, -1.0823486e+00, -2.0915797e+00,  9.8787868e-01,
        9.1636693e-01,  4.4796124e+00, -9.7120035e-01,  7.1369183e-01,
       -7.1794140e-01,  1.2255599e+00, -3.1637688e+00, -2.8718770e-01,
        1.3057554e+00,  6.3026869e-01, -3.1167827e+00,  7.0748255e-02,
        1.7510844e+00, -7.4019748e-01, -6.3971156e-01,  3.1766336e+00,
       -1.5264553e+00,  5.7078665e-01,  2.1815026e+00, -3.9932737e+00,
        6.1261332e-01, -9.4197744e-01, -1.0197893e+00, -1.5062371e-01,
       -6.8214780e-01,  2.4994497e+00, -8.8967907e-01,  2.5622687e+00,
       -6.9260120e-01,  1.0057415e+00, -6.1980188e-01,  9.8413217e-01,
        5.1628906e-01, -1.0585896e+00, -3.3607513e-01,  1.0261034e+00,
       -3.5063338e+00, -7.2565985e-01, -6.6972691e-01,  2.0531435e+00,
        1.2013927e+00,  2.2688198e+00, -1.6617675e-01,  1.3341041e+00,
        1.2065434e+00,  7.0766431e-01, -6.1419177e-01, -4.0443811e-01,
       -1.6977453e-01, -3.6748618e-01,  1.3656819e+00, -4.3798596e-01,
        5.6101727e-01, -1.6437542e+00,  5.7828236e-01,  2.2489737e-01,
        3.1447027e+00,  1.0215069e+00,  3.4394714e-01,  7.5194144e-01,
       -7.4118125e-01,  1.4060563e+00, -3.2965246e-01, -1.0311276e+00,
       -6.8306483e-02,  2.6606467e-01,  2.8796456e+00,  8.6687821e-01,
       -5.7838267e-01,  3.2869768e+00,  8.7835091e-01, -2.3154747e+00,
       -1.7096629e+00, -2.6128380e+00, -1.1326846e+00, -2.5346973e+00,
        4.6690506e-01, -1.9637979e+00, -2.2079057e-01, -7.0694262e-01,
        7.2061527e-01, -7.1900082e-01,  1.9324079e-01, -2.8481994e+00,
        1.4586244e+00, -2.2023368e+00,  2.8818493e+00,  1.9059685e+00,
        1.2797574e+00, -3.3661738e-02,  1.0472512e+00,  8.5907084e-01,
        8.9506346e-01,  5.0460070e-01,  4.6339089e-01,  2.6353493e+00,
       -1.9038318e+00, -5.9390146e-01, -6.8464088e-01, -1.2422029e+00,
        3.4537015e+00,  2.3622372e+00, -1.3976561e+00,  7.6274657e-01,
       -5.4056352e-01, -1.2112095e+00,  1.1866478e+00, -2.7617972e+00,
        1.1786115e+00,  5.8234755e-02, -1.9419889e-01, -1.8188047e+00,
       -2.0250039e+00, -1.6751802e+00,  2.2610784e+00, -2.8550696e-01,
        1.5249516e-01, -4.6106954e+00,  6.3850349e-01,  4.3945411e-01],
      dtype=float32)
```
