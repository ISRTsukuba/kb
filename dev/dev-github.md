# GitHubを使った開発

GitHubで入手可能なソースコードを自分のレポジトリとしてインポートして、VSCodeで編集するまでの手順。[研究室ナレッジベース](https://github.com/hideojoho/kb/)を例に説明します。

## 前提条件

- GitHubアカウント
- [Git](pc-git.md)
- [VSCode](pc-vscode.md)

## 所要時間

- 30分

## 作業場所の準備

- [第2作業エリア](pc-workspace.md)に、`GitHub`フォルダを作成
  - `C:\Home\sNNNNNNN\Workspace\GitHub`

## レポジトリのフォーク

GitHubで公開されているソースコードはレポジトリという単位で構成されています。
既存のソースコードを起点とした開発を行うためには、まず他者のアカウントが管理するレポジトリを
自分のアカウントにインポートします。これを「フォークする」といいます。

- [研究室ナレッジベースレポジトリ](https://github.com/hideojoho/kb/)にいく
- ページ右上の「Fork」アイコンを選択
- `Where should we fork kb?`と聞かれたら、自分のGitHubアカウントを選択
- 自分のアカウントに`kb`という名のレポジトリが追加されたことを確認
  - フォーク下レポジトリは、レポジトリ名の下に小さく`forked from ...`と表示される

## フォークしたレポジトリのクローン

- 自分のアカウントにフォークした研究室ナレッジベースレポジトリにいく
- 画面右側にある`Code`という緑のボタンを選択、表示されるレポジトリURLをコピー
- VSCodeを起動
  - `Ctrl+Shift+P`でコマンドパレットを表示し、`Git`と入力し、`Gitクローン`を選択
  - 表示される入力欄に、コピーしたレポジトリURLをペースト
  - 保存先をきかれるので、第2作業エリアに作成した`GitHub`フォルダを選択
  - レポジトリのクローンが始まる
  - ワークスペースへの追加を聞かれたら「開く」あるいは「新しいウィンドウで開く」を選択

## VSCodeでのブランチの選択

- GitHubのレポジトリには「ブランチ」という概念があります。デフォルトのブランチは`master`です。
- ブランチの使用方法はプロジェクトによりさまざまです。研究室ナレッジベースでは、日本語版（`ja`）と英語版（`en`）でブランチを分けています。
- クローンした直後では`master`ブランチが選択されている場合が多いと思います。VSCodeが使用しているブランチは、画面下部の左端に小さく表示されています（例：`master`）
- 例えば、研究室ナレッジベースの日本語ブランチに編集を加えたい場合は、`master`をクリックして表示されるブランチ一覧から`origin/ja`を選択します。
  - VSCodeの左パネルのファイル一覧が更新されて、日本語ブランチが持つフォルダが表示される
- :bulb: 一度選択したブランチは次回VSCodeを起動した際も継承されますが、編集を行う際は、自分が使っているブランチを確認する習慣をつけましょう。

## 編集内容のコミット

- では実際に自分用にクローンした研究室ナレッジベースの日本語ブランチにある文書を編集してみましょう
- VSCodeのファイル一覧から`dev`フォルダを選択、上のアイコンから「新しいファイル」をクリックし、`my-first-file.md`という名で保存
- ファイルが新規作成されたら適当な内容で編集し、保存
```
# はじめてのファイル

- ただいまGitHubのテスト中
```
- GitHubからクローンしたレポジトリに与えた何らかの変更（ファイルの新規作成、編集、削除、名前変更など）は、VSCodeの左端にある「ソース管理」から確認できます
- 例えば、今回の場合、`my-first-file.md`というファイルが「変更」ラベルの下に表示されます
- ファイル名の横に表示される`+`記号をクリックすると、「このファイルに加えた変更を自分のレポジトリに反映させる候補に加え」ます。これを「ステージする」と呼びます。
  - `my-first-file.md`をステージしましょう
  - 今度は「ステージされた変更」というリストに`my-first-file.md`が移動しました。
  - ステージングは単に「候補に加える」だけですので、候補一覧からいつでも取り消すことができます。ファイル名の横に表示される`-`記号を選択し、候補から外してみましょう
  - 次のステップに行く前に、もう一度 `my-first-file.md`をステージしておいてください
- 次に候補ファイルを自分のPCにクローンしたレポジトリに反映させます。これを「コミットする」と呼びます。コミットはステージしたファイルすべてを反映させます。ステージしていないファイルは対象外です。
  - 「メッセージ」に変化の内容を簡潔に入力します（例：`Initial commit`）
  - 上のチェックアイコンを選択
    - 「Gitのuser.nameとuser.emailを確認せよ」というダイアログが表示されたら、[Gitの設定](pc-git.md)をやり直しましょう
    - エラーが出なければ、コミットが完了しています。
- 最後に手元のレポジトリにコミットした内容をGitHubサイトのレポジトリに送ります。これを「プッシュする」と言います。
  - ソース管理パネルの上部アイコンから`・・・`を選択 → 「プッシュ」を選択
  - あるいは画面下部のブランチ名の隣にある⇅ラベル（変更を同期）を選択
  - これで手元の変更が自分のアカウントにフォークしたレポジトリに反映されました。
- フォークした自分のレポジトリページに行って、`ja`ブランチを選択し、`dev`フォルダの下に、`my-first-file.md`が追加せていることを確認しましょう
  - ブランチは`Master`と書かれているボタンをクリックすると選択できます
- また、[研究室ナレッジベースの日本語ブランチ](https://github.com/hideojoho/kb/tree/ja)に行って、`dev`フォルダの下に、`my-first-file.md`がないことを確認しましょう

## フォーク → ステージ → コミット → プッシュ

- フォークからプッシュまでの作業は慣れるまで少し分かりづらく、煩わしく感じると思います。
- フォークは他アカウントのレポジトリを自分のアカウントにコピーすることで、本家を気にせずに自由に変更を加えるようにするものです。
- コミットは1つの変更の塊に対して行います。ステージはその変更に関連するファイルのみを選択します。プッシュは変更内容をGitHubに送ります。
- 「機能Aの実装」と「機能Bの改善」という二つの変更の塊を実行した場合、以下のようにステージするファイルを選択してコミットします
  - 機能Aの実装に関連するファイル群をステージ → コミット
  - 機能Bの実装に関連するファイル群をステージ → コミット
- :bulb: 一方で同一ファイルが複数のコミットにまたがる可能性もあるので、一つの変更の塊が完了したら、コミットする習慣をつけましょう
  - ファイルのバックアップという意味でも、一日に1回はプッシュしておきましょう。
